<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:0,&quot;tests&quot;:1,&quot;passes&quot;:1,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-12-19T16:54:38.250Z&quot;,&quot;end&quot;:&quot;2025-12-19T16:54:42.528Z&quot;,&quot;duration&quot;:4278,&quot;testsRegistered&quot;:1,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;3b67b839-0c54-45a0-ab39-8be3201e2c99&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;cypress\\e2e\\BT7.cy.js&quot;,&quot;file&quot;:&quot;cypress\\e2e\\BT7.cy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Color Wheel - Quay và chọn đúng màu ngay lần đầu&quot;,&quot;fullTitle&quot;:&quot;Color Wheel - Quay và chọn đúng màu ngay lần đầu&quot;,&quot;duration&quot;:2611,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;cy.visit(\&quot;https://practice.expandtesting.com/color-wheel\&quot;);\n// Click Play Game để quay\ncy.contains(\&quot;button, a\&quot;, /play game/i).click();\n//  Chờ wheel dừng (màu tại mũi tên ổn định)\nwaitWheelStopAndGetColorAtArrow().then(targetRgb =&gt; {\n  // Lấy tất cả buttons đáp án màu (lọc bỏ Play/Reset)\n  cy.get(\&quot;button\&quot;).filter((_, el) =&gt; {\n    const t = (el.innerText || \&quot;\&quot;).trim();\n    return t.length &gt; 0 &amp;&amp; !/play game/i.test(t) &amp;&amp; !/reset game/i.test(t);\n  }).then($btns =&gt; {\n    const buttons = [...$btns];\n    // Đọc background-color từng nút -&gt; match gần nhất với targetRgb\n    const parsed = buttons.map(btn =&gt; {\n      const bg = getComputedStyle(btn).backgroundColor; // \&quot;rgb(r,g,b)\&quot; hoặc \&quot;rgba(...)\&quot;\n      const rgb = parseCssRgb(bg);\n      if (!rgb) return null;\n      return {\n        btn,\n        rgb,\n        text: (btn.innerText || \&quot;\&quot;).trim()\n      };\n    }).filter(Boolean);\n    expect(parsed.length, \&quot;Có danh sách nút màu\&quot;).to.be.greaterThan(0);\n    const best = parsed.map(x =&gt; _objectSpread(_objectSpread({}, x), {}, {\n      d: colorDistance(x.rgb, targetRgb)\n    })).sort((a, b) =&gt; a.d - b.d)[0];\n    cy.wrap(best.btn).click();\n    //  Assert kết quả (tùy UI, mình kiểm tra kiểu \&quot;Correct\&quot;/\&quot;Success\&quot;)\n    cy.contains(/correct|success|well done|great/i).should(\&quot;be.visible\&quot;);\n    cy.log(`Target RGB: ${targetRgb.join(\&quot;,\&quot;)} -&gt; Clicked: ${best.text}`);\n  });\n});\n// ===== Helpers =====\nfunction waitWheelStopAndGetColorAtArrow() {\n  // Lấy pixel ở vị trí đầu mũi tên (thường nằm phía trên giữa canvas)\n  // Nếu UI của bạn khác, chỉnh offset: x = w/2, y = 5..15\n  const sample = () =&gt; cy.get(\&quot;canvas\&quot;).then($c =&gt; {\n    const canvas = $c[0];\n    const ctx = canvas.getContext(\&quot;2d\&quot;);\n    const w = canvas.width;\n    const h = canvas.height;\n    // giả định mũi tên trỏ vào mép trên của vòng tròn (giữa trên)\n    const x = Math.floor(w / 2);\n    const y = Math.floor(h * 0.08); // ~8% chiều cao từ trên xuống\n    const data = ctx.getImageData(x, y, 1, 1).data; // [r,g,b,a]\n    return [data[0], data[1], data[2]];\n  });\n  // poll đến khi 3 lần liên tiếp giống nhau (wheel đã dừng)\n  return sample().then(c1 =&gt; {\n    return cy.wait(250).then(() =&gt; sample().then(c2 =&gt; {\n      return cy.wait(250).then(() =&gt; sample().then(c3 =&gt; {\n        const stable = colorDistance(c1, c2) &lt; 6 &amp;&amp; colorDistance(c2, c3) &lt; 6; // ngưỡng nhỏ\n        if (stable) return c3;\n        // chưa ổn định -&gt; đợi thêm rồi thử lại (đệ quy)\n        return cy.wait(300).then(() =&gt; waitWheelStopAndGetColorAtArrow());\n      }));\n    }));\n  });\n}\nfunction parseCssRgb(css) {\n  // \&quot;rgb(12, 34, 56)\&quot; hoặc \&quot;rgba(12,34,56,1)\&quot;\n  const m = css.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)/i);\n  if (!m) return null;\n  return [Number(m[1]), Number(m[2]), Number(m[3])];\n}\nfunction colorDistance(a, b) {\n  // khoảng cách Euclidean trong RGB\n  const dr = a[0] - b[0];\n  const dg = a[1] - b[1];\n  const db = a[2] - b[2];\n  return Math.sqrt(dr * dr + dg * dg + db * db);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3037dcc8-4ea3-4b10-80b5-cb0dc7e0b46d&quot;,&quot;parentUUID&quot;:&quot;3b67b839-0c54-45a0-ab39-8be3201e2c99&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3037dcc8-4ea3-4b10-80b5-cb0dc7e0b46d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2611,&quot;root&quot;:true,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;7.2.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.4&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;cypress/reports&quot;,&quot;overwrite&quot;:false,&quot;html&quot;:true,&quot;json&quot;:true},&quot;version&quot;:&quot;6.3.2&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;cypress/reports&quot;,&quot;reportTitle&quot;:&quot;Gr3&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:false,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;cypress\\reports\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\Gr3\\cypress\\reports\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;D:\\Gr3\\cypress\\reports\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>